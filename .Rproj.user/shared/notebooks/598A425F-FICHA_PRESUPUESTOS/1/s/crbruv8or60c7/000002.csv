"0","datamun <- fromJSON(params$url.dist_mun)"
"0","df_localizacion <- data.frame(mun = datamun[[""dimension""]][[""GEOGRAPHICAL""]][[""representation""]][[""code""]],"
"0","                              nombre = datamun[[""dimension""]][[""GEOGRAPHICAL""]][[""representation""]][[""title""]][[""es""]],"
"0","                              latitud = datamun[[""dimension""]][[""GEOGRAPHICAL""]][[""representation""]][[""latitude""]],"
"0","                              longitud = datamun[[""dimension""]][[""GEOGRAPHICAL""]][[""representation""]][[""longitude""]]) %>% "
"0","  filter(substring(mun, 0,2) != ""ES"")"
"0","df_localizacion$nombre <- recode_mun(df_localizacion, 'nombre')"
"2","The following `from` values were not present in `x`: Valsequillo, Santa María de Guía, Santa Lucía, Fuencaliente, Laguna (La), San Miguel, Vilaflor, Güimar, Icod de Los Vinos, San Juan de La Rambla
"
"0","distancias_mun <- df_localizacion %>%"
"0","  st_as_sf(coords = c(""longitud"", ""latitud""), crs = 4326) %>%"
"0","  st_distance"
"0","  "
"0","distancias_mun <- data.frame("
"0","  mun = df_localizacion$mun,"
"0","  nombre = df_localizacion$nombre,"
"0","  distancia = distancias_mun[as.numeric(rownames(df_localizacion[df_localizacion$mun == params$id_municipio, ])),] / 1000"
"0",")"
"0",""
"0","seleccion_mun <- function(df_variable, variable, p = 0.5) {"
"0","  df_dif <- df_variable %>% left_join(distancias_mun, by = ""mun"") "
"0","  mun_actual <- df_dif[df_dif$mun == params$id_municipio,]"
"0","  "
"0","  df_result <- df_dif %>%"
"0","    mutate("
"0","      dif = abs(df_dif[,variable] - mun_actual[1,variable]),"
"0","      distancia_N = scale(distancia),"
"0","      dif_N = scale(dif),"
"0","      coeficientes = p * distancia_N + (1-p) * dif_N"
"0","    ) %>%"
"0","  arrange(coeficientes)"
"0","  "
"0","  df_result[1:3,]"
"0","}"
